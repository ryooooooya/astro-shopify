---
import { type Categories } from "../utils/microcms";
import CartIcon from "./CartIcon.svelte";
import Logo from "./Logo.astro";

export interface Props {
  className?: string;
  currentPage?: string;
  categories: Categories[];
}
const { className,currentPage, categories } = Astro.props as Props;
---

<nav class={`${className} text-[28px] leading-8 z-10`} x-data="{ menuOpen: false, productOpen: false, contactOpen: false, modal: false }">
  <div class="absolute top-0 left-0 w-full h-full" x-show="modal" x-on:click="modal = false" x-transition />
  <div class="w-full h-16 hidden max-sm:flex justify-between items-center bg-gray-100">
    <h1 class="relative">
      <a href="/">
        SomeRoom
      </a>
    </h1>
    <div class="">
      <button class="cursor-pointer text-right" x-on:click="menuOpen = ! menuOpen" x-text="menuOpen ? 'Close' : 'Menu'"></button>
    </div>
  </div>
  <div class="h-[100vh] flex flex-col justify-between pt-6 pb-12 max-sm:bg-gray-100 max-sm:max-h-[calc(100vh-64px)] max-sm:overflow-y-scroll" x-bind:class="menuOpen ? 'max-sm:flex' : 'max-sm:hidden'" x-transition>
    <div class="flex flex-col gap-y-12">
      <h1 class="relative max-sm:hidden">
        <a href="/">
          <Logo />
        </a>
      </h1>
      <ul class="relative flex flex-col gap-y-4">
        <!-- PC -->
        <span class="max-sm:hidden">
          <li class={`${currentPage == "product" && ("currentPage")}`}>
            <buttton class="cursor-pointer" x-on:click="productOpen = ! productOpen, modal = ! modal">Products</buttton>
          </li>
        </span>
        <!-- SP -->
        <span class="hidden max-sm:block">
          <li class={`${currentPage == "product" && ("currentPage")}`}>
            <a href="/">Products</a>
          </li>
          <ul class="flex flex-col gap-y-2 pl-3 pt-2">
            <li>
              <a href="/">ALL</a>
            </li>
            {categories.map((category) => (
              <li class="whitespace-nowrap">
                <a href={`/categories/${category.id}`} class={`${currentPage == category.id && ("currentPage")}`}>{category.name}</a>
              </li>
            ))}
          </ul>
        </span>
        <li class={`${currentPage == "designers" && ("currentPage")}`}>
          <a href="/designers">Designers</a>
        </li>
        <li class={`${currentPage == "series" && ("currentPage")}`}>
          <a href="/series">Series</a>
        </li>
        <li class={`${currentPage == "cart" && ("currentPage")}`}>
          <CartIcon client:load />
        </li>
        <div class="absolute -top-4 left-[140px] flex flex-col gap-y-4 bg-white p-4" x-show="productOpen" x-on:click.away="productOpen = false, modal = false" x-cloak>
          <a href="/">ALL</a>
          {categories.map((category) => (
            <li class="whitespace-nowrap">
              <a href={`/categories/${category.id}`} class={`${currentPage == category.id && ("currentPage")}`}>{category.name}</a>
            </li>
          ))}
        </div>
      </ul>
    </div>
    <ul class="relative flex flex-col gap-y-4 mt-10">
      <li class={`${currentPage == "about" && ("currentPage")}`}>
        <a href="/about">About</a>
      </li>
      <span class="max-sm:hidden">
        <li class="relative">
          <buttton class="cursor-pointer" x-on:click="contactOpen = ! contactOpen, modal = ! modal">Contact</buttton>
          <div class="absolute -top-4 left-[120px] flex flex-col gap-y-4 bg-white p-4" x-show="contactOpen" x-on:click.away="contactOpen = false, modal = false" x-cloak>
            info@someroom.net
          </div>
        </li>
      </span>
      <span class="hidden max-sm:block">
        <li>
          <p>
            Contact : info@someroom.net
          </p>
        </li>
      </span>
      <li>
        <a href="https://www.instagram.com/someroomdesign/" target="_blank" rel="noopener noreferrer">Instagram</a>
      </li>
    </ul>
  </div>
</nav>
