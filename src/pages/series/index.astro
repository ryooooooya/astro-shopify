---
import { getSeries, getProducts } from "../../utils/microcms";
import BaseLayout from "../../layouts/BaseLayout.astro";
import ProductCardByMicrocms from "../../components/ProductCardByMicrocms.astro";

const title = "Astro + Shopify";

const series = await getSeries({
  limit: 100
});
const products = await getProducts({
  limit: 100
});
---

<BaseLayout title={title}>
  <!-- <div class="col-span-10">
    <h2 class="text-2xl">
      シリーズ
    </h2>
  </div> -->
  <div class="col-span-10 grid grid-cols-subgrid gap-10">
  {series.contents.map((content: any) => (
    <div class="col-span-10 grid grid-cols-subgrid gap-10">
      <div class="col-span-2">
        <h3 class="text-2xl">{content.title}</h3>
        <p class="mt-4 text-sm">
          {content.text}
        </p>
        <a href={`/series/${content.id}`} class="block underline underline-offset-6 mt-4 text-sm hover:no-underline">
          すべて見る
        </a>
      </div>
      <div class="col-span-8 grid grid-cols-subgrid gap-10">
        {products.contents.map((product: any) => (
          <>
            {product.series.map((ser: any) => (
              ser.id === content.id && (
                <ProductCardByMicrocms product={product} className="col-span-2"/>
              )
            ))}
          </>
        ))}
      </div>
    </div>
  ))}
  </div>
</BaseLayout>