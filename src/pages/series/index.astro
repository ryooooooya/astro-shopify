---
import { getSeries, getProducts } from "../../utils/microcms";
import BaseLayout from "../../layouts/BaseLayout.astro";
import ProductCardByMicrocms from "../../components/ProductCardByMicrocms.astro";

const title = "Astro + Shopify";

const series = await getSeries({
  limit: 100
});
const products = await getProducts({
  limit: 100
});
---

<BaseLayout title={title} currentPage="series">
  <section class="h-full pt-10 pb-12">
    <h2 class="text-xs">
      All series:
    </h2>
    <div class="flex flex-col gap-y-16 mt-3">
      {series.contents.map((content: any) => (
        <div class="grid grid-cols-5 gap-12">
          <a href={`/series/${content.id}`} class="">
            <h3 class="text-xl text-underline hover:no-underline">
              {content.title}
            </h3>
            <p class="mt-2 text-base line-clamp-5">
              {content.text}
            </p>
          </a>
          <>
            {products.contents.map((product: any) => (
              <>
                {product.series.map((ser: any) => (
                  ser.id === content.id && (
                    <ProductCardByMicrocms product={product} className="c" noSeries/>
                  )
                ))}
              </>
            ))}
          </>
        </div>
      ))}
    </div>
  </section>
</BaseLayout>